# -----------------------------------------------------------------------------
#
# (c) 2011 Tsitsimpis Ilias
#
# This file is part of the GAC build system.
#
# To understand how the build system works and how to modify it, see HACKING
#
# -----------------------------------------------------------------------------


PREFIX  = @prefix@
TAR     = @TarCmd@

VERSION = @PACKAGE_VERSION@
PACKAGE = @PACKAGE_TARNAME@
ARCHIVE = $(PACKAGE)-$(VERSION)

.PHONY: all install dist clean distclean maintainer-clean test

all:
	$(MAKE) -C src $@

install:
	$(MAKE) -C src $@

dist:
	@echo "Cleaning all the generated files.."
	$(MAKE) maintainer-clean
	$(RM) -r $(ARCHIVE)
	$(RM) $(ARCHIVE).tar.gz
	@echo "Copying files.."
	mkdir $(ARCHIVE)
	$(TAR) cf - --exclude=$(ARCHIVE) --exclude-vcs * | \
		(cd $(ARCHIVE) && tar xf -)
	@echo "Generating archive.."
	$(TAR) zcf $(ARCHIVE).tar.gz $(ARCHIVE)
	@echo "Clean temp files.."
	$(RM) -r $(ARCHIVE)

clean:
	$(MAKE) -C src $@

distclean: clean
	$(RM) Makefile src/Makefile src/config.h src/gac.cabal
	$(RM) config.log config.status

maintainer-clean: distclean
	$(RM) -r autom4te.cache

test:
	@echo "Coming soon.."
